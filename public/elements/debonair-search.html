<link rel="import" type="text/html" href="/lib/iron-icons/iron-icons.html">
<link rel="import" type="text/html" href="/lib/iron-iconset-svg/iron-iconset-svg.html">
<link rel="import" type="text/html" href="/lib/paper-icon-button/paper-icon-button.html">

<dom-module id="debonair-search">
	<style>
		.no-display {
			display: none;
		}

		#header_search_field {
			background-color: inherit;
			border: none;
			font-size: 20px;
			outline: none;
			cursor: auto;
			color: #EF5350;
			letter-spacing: 5px;
			text-transform: uppercase;
			display: table-cell;
			width: 100%;
			padding-top: 7px;
		}

		#search-icon {
			color: #EF5350;
		}

		#wrapper {
			background-color: inherit;
		}
	</style>
	<template>
		<section id="wrapper" class="horizontal layout flex">
			<section id="search-icon">
				<paper-icon-button icon="search" on-click="toggleVisibility"></paper-icon-button>
			</section>
			<section id="header_search" class="flex no-display">
				<input 
					id="header_search_field" 
					type="search" 
					autocomplete="off" 
					on-focusout="toggleVisibility" 
					on-keyup="searchHandler">
			</section>
		</section>
	</template>
</dom-module>

<script type="text/javascript">
	Polymer({
		is: "debonair-search",
		properties: {
			searchActivated: {
				type: Boolean,
				value: false,
				observer: '_searchActivatedChanged'
			}
		},
		searchHandler: function(e)
		{
			if(e.keyCode === 27)
			{
				this.$.header_search_field.blur();
			}
		},
		toggleVisibility: function(bool)
		{
			if(typeof bool === 'boolean')
			{
				this.searchActivated = bool;
			}
			this.searchActivated = !this.searchActivated;
		},
		_changeView: function()
		{
			if(this.searchActivated)
			{
				this.$.header_search.classList.remove('no-display');
				this.$.header_search_field.focus();
				return;
			}
			this.$.header_search.classList.add('no-display');
			this.$.header_search_field.value = '';
		},
		_searchActivatedChanged: function(new_value)
		{
			this._changeView();
			this.fire('search-changed', { isSearchActivated: new_value });
		}
	});
</script>