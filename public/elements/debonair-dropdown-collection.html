<link rel="import" type="text/html" href="/elements/debonair-dropdown.html">
<link rel="import" type="text/html" href="/lib/paper-toolbar/paper-toolbar.html">

<dom-module id="debonair-dropdown-collection">
	<style>
		paper-toolbar {
			--paper-toolbar-background: #FFF;
			color: #9A8194;
			font-weight: 200;
		}
		.filter_item {
			padding-right: 2%;
		}
		.filter_chip {
			color: #340228;
			font-size: 15px;
			background-color: #FFF;
			border: solid #340228 thin;
			margin-right: 1%;
			border-radius: 15px;
		}

		.filter_chip > span {
			padding: 10px;
		}

		.chips {
			padding-top: 10px;
		}

		.chip_close {
			padding-left: 10px;
			cursor: pointer;
		}
	</style>
	<template>
		<section class="horizontal flex layout">
			<template is="dom-repeat" items="{{filters}}" as="filter">
				<div class="filter_item">
					<debonair-dropdown title="{{filter.type}}" items="{{filter.items}}" on-select="handleDropDownSelect"></debonair-dropdown>
				</div>
			</template>
		</section>
		<section class="horizontal layout chips">
			<template is="dom-repeat" items="{{selectedFilters}}" as="chip">
				<div class="filter_chip">
					<span>{{chip.item}}<span><span class="chip_close" on-tap="handleChipClose">x</span>
				</div>
			</template>
		</section>
	</template>
</dom-module>s

<script type="text/javascript">
	Polymer({
		is: "debonair-dropdown-collection",
		handleDropDownSelect: function(e)
		{
			this.removeFilter(e.detail);
			this.addChip(e.detail);
		},
		handleChipClose: function(e)
		{
			this.removeChip(e.model.chip);
			// this.addFilter(e.model.chip);
		},
		addFilter: function(chip)
		{
			for(var i = 0; i < this.filters.length; i++)
			{
				if(this.filters[i].type === chip.type)
				{
					var path = "filters." + i + ".items";
					this.push(path, chip.item);
				}
			}
		},
		removeFilter: function(chip)
		{
			for(var i = 0; i < this.filters.length; i++)
			{
				if(this.filters[i].type === chip.type)
				{
					var path = "filters." + i + ".items";
					this.splice(path, this.filters[i].items.indexOf(chip.item), 1);
				}
			}
		},
		addChip: function(chip)
		{
			this.push('selectedFilters', {item: chip.item, type: chip.type});
		},
		removeChip: function(chip)
		{
			this.splice('selectedFilters', this.selectedFilters.indexOf(chip.item));
		},
		ready: function()
		{
			this.selectedFilters = [];

			this.filters = [
				{
					type: "GENRE",
					items: [
						"Shounen",
						"Adventure",
						"Slice of Life",
						"Harem",
						"Shoujo",
						"Romance",
						"Seinen",
						"Ecchi",
						"Mature"
					]
				},
				{
					type: "CHAPTERS",
					items: [
						"0 - 50",
						"50 - 100",
						"100 - 150",
						"150 - 200",
						"200 - 250",
						"250 - 300",
						"300 - Up"
					]
				},
				{
					type: "STATUS",
					items: [
						"Ongoing",
						"Complete"
					]
				}
			];
		}
	});
</script>